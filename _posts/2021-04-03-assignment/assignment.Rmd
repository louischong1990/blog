---
title: "Assignment"
description: |
  Assignment as part of Visual Analytics Project titled VISTAS - Visualising Industry Skill TAlent Shifts.
author:
  - name: Louis Chong Jia Jun (louis.chong.2019@mitb.smu.edu.sg)
    url: https://www.linkedin.com/in/louis-chong-jia-jun
date: 04-03-2021
output:
  distill::distill_article:
    self_contained: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1.0 Overview

# 1.1 Background

The LinkedIn and World Bank Group have partnered and released data from 2015 to 2019 that focuses on 100+ countries with at least 100,000 LinkedIn members each, distributed across 148 industries and 50,000 skill categories. This data aims to help government and researchers understand rapidly evolving labor markets with detailed and dynamic data (The World Bank Group, 2021).

# 1.2 Data

The proposed datasets for analyses will mainly come from the [LinkedIn-World Bank partnership](https://linkedindata.worldbank.org/). This will be complemented with [GDP per capita from World Bank](https://data.worldbank.org/indicator/NY.GDP.PCAP.CD).

In this assignment, the following datasets from LinkedIn-World Bank will be used:

* Industry Employment Growth: Growth rate of employment in each industry in each country from 2015-2019 (78 distinct industries)
* Industry Migration: Change in number of people in each industry in each country from 2015-2019
* Skill Migration: Change in number of people with each skill in each country from 2015-2019
* Industry Skills Need: Top 10 skills required in each industry from 2015-2019

The GDP per capita dataset, which comprises annual time-series GDP per capita (current USD) for countries, is also used.

# 1.3 Critiques of Existing Data Visualisations

Simple data visualisations are publicly available at [LinkedIn-World Bank](https://linkedindata.worldbank.org/data) webpage. However, they are limited in the exploration of trends because they only allow one parameter of choice.

In terms of how variables relate to one another, there are limitations to studies done so far. Studies on relationship between GDP per capita growth rate and population growth are usually done at country level, so more studies can be done to analyse the relationship between GDP per capita growth rate and employment growth or migration in each industry. Figure 1 shows the relationship between employment growth and interstate migration ([Tunny, G., 2015](https://queenslandeconomywatch.com/2015/03/29/feedback-between-interstate-migration-and-employment-growth/)). Here, analysis is done at state level, but not industry level.

![Figure 1: Employment Growth vs Interstate Migration](https://raw.githubusercontent.com/louischong1990/blog/master/Assignment/Images/Picture1.png)

Figure 2 shows the relationship between GDP per capita and share of employment in business services in 2000 for countries in Europe [Kox, H. & Rubalcaba, L., 2007](https://www.researchgate.net/publication/5007988_Business_services_and_the_changing_structure_of_European_economic_growth). However, this does not show how a change in migration or employment growth in an industry will cause the change in GDP per capita.

![Figure 2: GDP per capita vs Share of employment in business services in Europe in 2000](https://raw.githubusercontent.com/louischong1990/blog/master/Assignment/Images/Picture2.png)

Overall, these data visualisations mentioned are static and do not allow readers to find out how the change in GDP per capita is influenced by the change in employment and migration in each industry or skill and how the change in employment in influenced by change in migration in each industry or skill.

# 1.4 Motivation

Through this project, we will create a user-friendly, interactive dashboard that allows individuals and countries to view their competitive advantage and understand the evolving labour markets across the world in four areas: skills, occupations, migration and industries. Comparison will be allowed at both country-level and industry-level. The project will help answer the following questions:

For individuals:

* [1A] Increasing employability - What are the highly sought-after skills to build up to increase employability in a particular country or a particular sector?
* [1B] Employment opportunities - Which country holds better employment opportunities for certain skills or certain industry?
* [1C] Migration Trends - Which country are people e.g. fellow countrymen, migrating to?

For countries:

* [2A] Migration Trends - Where are our (countryâ€™s) talent migrating to?
* [2B] Skill Trends - What are the skills lost or gained in our country or in the sectors in our country?
* [2C] Learning from other countries - Which skills (i.e. top skill needs in each industry) do we encourage and train in our own people to increase the competitiveness of our labour market against other countries?
* [2D] Skill and Industry Trends - Are we losing or gaining the skills or industries we desire and according to plan? How do we change this, if required?
* [2E] GDP per capita growth - How is GDP per capita growth impacted by migration and employment growth in our country?

This assignment will build regression and correlation plots to answer questions 1A, 1B and 2E.

# 1.5 Sketch of Data Visualisation

Figure 3 shows the sketch of the proposed data visualisation.

![Figure 3: Sketch of Proposed Data Visualisation](https://raw.githubusercontent.com/louischong1990/blog/master/Assignment/Images/Picture3.png)

# 1.6 Advantages and Components of Data Visualisation

For this assignment, the proposed data visualisation is an interactive dashboard with regression and correlation plots. It can be filtered according to country, region, year, income level, industry section, industry, skill category and skill to show different plots. Users can choose two parameters and find out the relationship between GDP per capita growth and industry employment growth/industry migration/skill migration, or industry employment growth and industry/skill migration. Correlation of GDP per capita growth, industry employment growth, industry migration and skill migration can also be determined.

The following packages are used to build the respective plots:

* Regression Plot with Histograms as Marginal Distributions (ggstatsplot - ggscatterstats)
* Correlation Plot (ggstatsplot - ggcorrmat)

Unlike R Shiny, we are unable to have an interactive filter on R Markdown that can filter the dataset and directly change the regression and correlation plots. Crosstalk, d3scatter and lazyeval packages allow interactive filter on R Markdown, but are only compatible with data tables and scatter plots. Thus, in this assignment, we will first use crosstalk, d3scatter and lazyeval packages to filter and explore the distributions of variables on scatter plots, before we manually adjust the code and filter the dataset, which will change the regression and correlation plots.

# 2.0 Step-by-Step Data Visualisation Preparation

# 2.1 Installing and Launching R Packages

First, we will install and launch the relevant R packages.

If d3scatter package has not been installed before, we can run the following two commands.

```{r eval=FALSE}
packages = c('devtools')

for(p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
  library(p, character.only = T)
}
```

```{r eval=FALSE}
devtools::install_github("jcheng5/d3scatter")
```

If d3scatter package has already been installed, we can run the following command to install and launch all relevant R packages. In addition to the packages mentioned in the earlier sections, the readxl package is required to read xlsx files and the tidyverse package is needed to import data (read_csv), do data cleaning and manipulation (dplyr, tidyr). The olsrr package is also used to find out detailed results of the regression plots for further discussion in this assignment.

```{r message=FALSE, warning=FALSE}
packages = c('readxl', 'devtools', 'crosstalk', 'd3scatter',
             'lazyeval', 'tidyverse', 'ggstatsplot', 'olsrr')

for(p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
  library(p, character.only = T)
}
```

# 2.2 Load Datasets onto R

Next, we will load the necessary datasets for this assignment, which include GDP per capita, industry employment growth, industry migration, skill migration and industry skills need.

```{r message=FALSE, warning=FALSE}
industryEmploymentGrowth <- read_excel("data/public_use-industry-employment-growth.xlsx",
                                       sheet = "Growth from Industry Transition")

industrySkillsNeeds <- read_excel("data/public_use-industry-skills-needs.xlsx",
                                  sheet = "Industry Skills Needs")

industryMigration <- read_excel("data/public_use-talent-migration.xlsx",
                                sheet = "Industry Migration")

skillMigration <- read_excel("data/public_use-talent-migration.xlsx",
                             sheet = "Skill Migration")

gdpPerCapita <- read_csv("data/API_NY.GDP.PCAP.CD_DS2_en_csv_v2_2055804.csv")
```

# 2.3 Data Wrangling

After loading the datasets, we will do the necessary data cleaning and manipulation.

The GDP per capita dataset contains GDP per capita for various countries over many years. First, we change the column name from "Country Name" to "country_name" to be consistent with other datasets. We also change the column names e.g. from "2019" to "gpc2019", as the numerical labelling may result in difficulties in data wrangling. Only relevant columns are kept i.e. country, GDP per capita from 2014 to 2019. Next, to determine the change in GDP per capita year on year for 2015 to 2019, we apply the formulas and keep only relevant columns i.e. country, GDP per capita growth for 2015 to 2019. Lastly, we use pivot_longer to place GDP per capita growth in rows instead of columns. The name of the column storing the original values of the columns is titled "GDP_per_capita_growth" and the name of the column storing the original names of the columns is titled "year". We also edit to keep only values of the year i.e. from "gpc2019" to "2019".

```{r message=FALSE}
names(gdpPerCapita)[1] <- "country_name"

names(gdpPerCapita)[59] <- "gpc2014"
names(gdpPerCapita)[60] <- "gpc2015"
names(gdpPerCapita)[61] <- "gpc2016"
names(gdpPerCapita)[62] <- "gpc2017"
names(gdpPerCapita)[63] <- "gpc2018"
names(gdpPerCapita)[64] <- "gpc2019"

gdpPerCapita <- gdpPerCapita[-c(2:58, 65)]

gdpPerCapita$g2015 <- (gdpPerCapita$gpc2015/gdpPerCapita$gpc2014) - 1
gdpPerCapita$g2016 <- (gdpPerCapita$gpc2016/gdpPerCapita$gpc2015) - 1
gdpPerCapita$g2017 <- (gdpPerCapita$gpc2017/gdpPerCapita$gpc2016) - 1
gdpPerCapita$g2018 <- (gdpPerCapita$gpc2018/gdpPerCapita$gpc2017) - 1
gdpPerCapita$g2019 <- (gdpPerCapita$gpc2019/gdpPerCapita$gpc2018) - 1

gdpPerCapita <- gdpPerCapita[-c(2:7)] %>%
  pivot_longer(cols = c(`g2015`, `g2016`, `g2017`, `g2018`, `g2019`),
               names_to = "year",
               values_to = "GDP_per_capita_growth") %>%
  mutate(year = str_sub(year, 2, -1))
```

The industry employment growth dataset contains employment growth rate for various industries in various countries from 2015 to 2019. We will keep only relevant columns i.e. country, region, income, industry, employment growth for 2015 to 2019. Next, we use pivot_longer to place industry employment growth in rows instead of columns. The name of the column storing the original values of the columns is titled "employment_growth" and the name of the column storing the original names of the columns is titled "year". We also edit to keep only values of the year i.e. from "growth_rate_2019" to "2019".

```{r message=FALSE}
industryEmploymentGrowth <- industryEmploymentGrowth[-c(1, 5, 7)] %>%
  pivot_longer(cols = c(`growth_rate_2015`, `growth_rate_2016`, `growth_rate_2017`,
                        `growth_rate_2018`, `growth_rate_2019`),
               names_to = "year",
               values_to = "employment_growth") %>%
  mutate(year = str_sub(year, 13, -1))
```

The industry migration dataset contains migration data for various industries in various countries from 2015 to 2019. We will keep only relevant columns i.e. country, region, income, industry, migration for 2015 to 2019. Next, we use pivot_longer to place industry migration in rows instead of columns. The name of the column storing the original values of the columns is titled "industry_migration" and the name of the column storing the original names of the columns is titled "year". We also edit to keep only values of the year i.e. from "net_per_10k_2019" to "2019". Lastly, we will normalise industry migration by dividing by 1000 i.e. industry migration (net per 10) to have a common scale with GDP per capita growth and industry employment growth.

```{r message=FALSE}
industryMigration <- industryMigration[-c(1, 5, 7)] %>%
  pivot_longer(cols = c(`net_per_10K_2015`, `net_per_10K_2016`, `net_per_10K_2017`,
                        `net_per_10K_2018`, `net_per_10K_2019`),
               names_to = "year",
               values_to = "industry_migration") %>%
  mutate(year = str_sub(year, 13, -1)) %>%
  mutate(industry_migration = industry_migration / 1000)
```

The skill migration dataset contains migration data for various skills in various countries from 2015 to 2019. We will keep only relevant columns i.e. country, region, income, skill, skill migration for 2015 to 2019. Next, we use pivot_longer to place skill migration in rows instead of columns. The name of the column storing the original values of the columns is titled "skill_migration" and the name of the column storing the original names of the columns is titled "year". We also edit to keep only values of the year i.e. from "net_per_10k_2019" to "2019". Lastly, we will normalise skill migration by dividing by 1000 i.e. skill migration (net per 10) to have a common scale with GDP per capita growth and industry employment growth.

```{r message=FALSE}
skillMigration <- skillMigration[-c(1, 5)] %>%
  pivot_longer(cols = c(`net_per_10K_2015`, `net_per_10K_2016`, `net_per_10K_2017`,
                        `net_per_10K_2018`, `net_per_10K_2019`),
               names_to = "year",
               values_to = "skill_migration") %>%
  mutate(year = str_sub(year, 13, -1)) %>%
  mutate(skill_migration = skill_migration / 1000)
```

The industry skills need dataset contains the top 10 skill needs for each industry from 2015 to 2019. We will merge skill migration and industry skill need datasets to form the industrySkillMigration data table and show the industries which the skills are needed in.

```{r message=FALSE}
industrySkillsNeeds <- industrySkillsNeeds[-c(2, 7)]
industrySkillMigration <- merge(skillMigration, industrySkillsNeeds,
                                by = c("year", "skill_group_category",
                                       "skill_group_name"))
```

Various datasets are then merged to have various visualisations of regression and correlation. They are as follows.

* master1: merge GDP per capita and industry employment growth datasets to compare GDP per capita growth with industry employment growth
* master2: merge GDP per capita and industry migration datasets to compare GDP per capita growth with industry migration
* master3: merge GDP per capita and skill migration datasets to compare GDP per capita growth with skill migration
* master4: merge industry employment growth and industry migration datasets to compare industry employment growth and industry migration
* master5: merge industry employment growth and industry skill migration datasets to compare industry employment growth and industry skill migration
* master6: merge master2 and master5 to have a master data table containing values of GDP per capita growth, industry employment growth, industry migration and skill migration

```{r message=FALSE}
master1 <- merge(industryEmploymentGrowth, gdpPerCapita,
                 by = c("country_name", "year"))
master2 <- merge(industryMigration, gdpPerCapita,
                 by = c("country_name", "year"))
master3 <- merge(skillMigration, gdpPerCapita,
                 by = c("country_name", "year"))
master4 <- merge(industryEmploymentGrowth, industryMigration,
                 by = c("country_name", "year", "wb_region", "wb_income",
                        "isic_section_name", "industry_name"))
master5 <- merge(industryEmploymentGrowth, industrySkillMigration,
                 by = c("country_name", "year", "wb_region", "wb_income",
                        "isic_section_name", "industry_name"))
master6 <- merge(master5, master2,
                 by = c("country_name", "year", "wb_region", "wb_income",
                        "isic_section_name", "industry_name"))
```

# 2.4 Interactive Scatter Plots

For simplicity in this assignment, we will use master6, even though there may be less observations when the data tables are merged.

In this section, we will use crosstalk and d3scatter packages to create interactive scatter plots. They are filtered by country, region, year, income level, industry section, industry, skill category and skill. By default, all options are chosen and multiple options can selected for the filters. They are also coloured by year to show the differences over the years. The limitations are the long processing time, inability to adjust the orientation of the axes labels and the inability to place the reference lines at zero for aesthetic purpose. Nonetheless, the interactive scatter plots are more for exploratory purpose for this assignment, so we won't adjust the aesthetics of the scatter plots further. 

The following scatter plots are plotted:

* GDP per capita growth vs Employment growth

```{r}
shared_master <- SharedData$new(master6)

bscols(widths = c(3,NA),
       list(
         filter_select("country_name", "Country",
                       shared_master, ~country_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("year", "Year",
                       shared_master, ~year,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("wb_region", "Region",
                       shared_master, ~wb_region,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("wb_income", "Income Level",
                       shared_master, ~wb_income,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("isic_section_name", "Industry Section",
                       shared_master, ~isic_section_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("industry_name", "Industry",
                       shared_master, ~industry_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("skill_group_category", "Skill Category",
                       shared_master, ~skill_group_category,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("skill_group_name", "Skill",
                       shared_master, ~skill_group_name,
                       allLevels = TRUE, multiple = TRUE)
       ),
       d3scatter(shared_master, ~employment_growth, ~GDP_per_capita_growth, ~year,
                 x_label = "Employment Growth",
                 y_label = "GDP Per Capita Growth",
                 width = "100%", height = 500)
)
```

* GDP per capita growth vs Industry migration

```{r}
bscols(widths = c(3,NA),
       list(
         filter_select("country_name", "Country",
                       shared_master, ~country_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("year", "Year",
                       shared_master, ~year,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("wb_region", "Region",
                       shared_master, ~wb_region,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("wb_income", "Income Level",
                       shared_master, ~wb_income,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("isic_section_name", "Industry Section",
                       shared_master, ~isic_section_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("industry_name", "Industry",
                       shared_master, ~industry_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("skill_group_category", "Skill Category",
                       shared_master, ~skill_group_category,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("skill_group_name", "Skill",
                       shared_master, ~skill_group_name,
                       allLevels = TRUE, multiple = TRUE)
       ),
       d3scatter(shared_master, ~industry_migration, ~GDP_per_capita_growth, ~year,
                 x_label = "Industry Migration (Net Per 10)",
                 y_label = "GDP Per Capita Growth",
                 width = "100%", height = 500)
)
```

* GDP per capita growth vs Skill migration

```{r}
bscols(widths = c(3,NA),
       list(
         filter_select("country_name", "Country",
                       shared_master, ~country_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("year", "Year",
                       shared_master, ~year,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("wb_region", "Region",
                       shared_master, ~wb_region,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("wb_income", "Income Level",
                       shared_master, ~wb_income,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("isic_section_name", "Industry Section",
                       shared_master, ~isic_section_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("industry_name", "Industry",
                       shared_master, ~industry_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("skill_group_category", "Skill Category",
                       shared_master, ~skill_group_category,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("skill_group_name", "Skill",
                       shared_master, ~skill_group_name,
                       allLevels = TRUE, multiple = TRUE)
       ),
       d3scatter(shared_master, ~skill_migration, ~GDP_per_capita_growth, ~year,
                 x_label = "Skill Migration (Net Per 10)",
                 y_label = "GDP Per Capita Growth",
                 width = "100%", height = 500)
)
```

* Employment growth vs Industry migration

```{r}
bscols(widths = c(3,NA),
       list(
         filter_select("country_name", "Country",
                       shared_master, ~country_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("year", "Year",
                       shared_master, ~year,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("wb_region", "Region",
                       shared_master, ~wb_region,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("wb_income", "Income Level",
                       shared_master, ~wb_income,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("isic_section_name", "Industry Section",
                       shared_master, ~isic_section_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("industry_name", "Industry",
                       shared_master, ~industry_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("skill_group_category", "Skill Category",
                       shared_master, ~skill_group_category,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("skill_group_name", "Skill",
                       shared_master, ~skill_group_name,
                       allLevels = TRUE, multiple = TRUE)
       ),
       d3scatter(shared_master, ~industry_migration, ~employment_growth, ~year,
                 x_label = "Industry Migration (Net Per 10)",
                 y_label = "Employment Growth",
                 width = "100%", height = 500)
)
```

* Employment growth vs Skill migration

```{r}
bscols(widths = c(3,NA),
       list(
         filter_select("country_name", "Country",
                       shared_master, ~country_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("year", "Year",
                       shared_master, ~year,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("wb_region", "Region",
                       shared_master, ~wb_region,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("wb_income", "Income Level",
                       shared_master, ~wb_income,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("isic_section_name", "Industry Section",
                       shared_master, ~isic_section_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("industry_name", "Industry",
                       shared_master, ~industry_name,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("skill_group_category", "Skill Category",
                       shared_master, ~skill_group_category,
                       allLevels = TRUE, multiple = TRUE),
         filter_select("skill_group_name", "Skill",
                       shared_master, ~skill_group_name,
                       allLevels = TRUE, multiple = TRUE)
       ),
       d3scatter(shared_master, ~skill_migration, ~employment_growth, ~year,
                 x_label = "Skill Migration (Net Per 10)",
                 y_label = "Employment Growth",
                 width = "100%", height = 500)
)
```

In this assignment, we will focus on 2019 dataset for information and communication industry or tech skills, given the relevance to SMU MITB students. By applying the filters i.e. year (2019), industry section (information and communication) and skill category (tech skills), the above interactive scatter plots will produce Figures 4-8.

![Figure 4: GDP per capita vs Employment Growth](https://raw.githubusercontent.com/louischong1990/blog/master/Assignment/Images/Picture4.png)


![Figure 5: GDP per capita vs Industry migration](https://raw.githubusercontent.com/louischong1990/blog/master/Assignment/Images/Picture5.png)


![Figure 6: GDP per capita vs Skill migration](https://raw.githubusercontent.com/louischong1990/blog/master/Assignment/Images/Picture6.png)


![Figure 7: Employment growth vs Industry migration](https://raw.githubusercontent.com/louischong1990/blog/master/Assignment/Images/Picture7.png)


![Figure 8: Employment growth vs Skill migration](https://raw.githubusercontent.com/louischong1990/blog/master/Assignment/Images/Picture8.png)

# 2.5 Filtered Datasets

Next, we will edit the code to filter master6. Two filtered data tables are created, one filtered by year 2019 and information and communication industry and the other filtered by year 2019 and tech skills. These will be used to find specific results under the regression and correlation plots. With the results, countries can find out how GDP per capita growth is impacted by changes in employment and migration for information and communication industry and tech skill. Users can also find out the relationship between employment growth and migration for information and communication industry and tech skill to find potential job opportunities.

```{r message=FALSE}
filtered_master1 <- master6 %>%
  filter(isic_section_name == "Information and communication") %>%
  filter(year == 2019)

filtered_master2 <- master6 %>%
  filter(skill_group_category == "Tech Skills") %>%
  filter(year == 2019)
```

# 2.6 Regression Plots

Using the filtered data tables, we will create the respective regression plots as seen below. ggstatsplot package is used instead of ggplot package, as it allows histograms to be plotted (marginal distributions) and we can analyse the distributions of both variables in the regression plots.

For the regression plots, the title, axes (xlab, ylab) and source (caption) are labelled appropriately. The y axis label is rotated to improve readability. The plots are coloured by year. Note that since the filtered data tables contain data only from year 2019, there will only be one colour seen here. Reference lines are drawn at zero to allow users to distinguish between positive and negative easily. The default 95% confidence interval is used and the results of the statistical tests are displayed. From the plots, we note that the distributions of all the variables follow a normal distribution. We will further discuss the results in the later section.

In addition, we will use the olsrr package to show the results of each regression plot, as it's easier to understand and interpret.

* GDP per capita growth vs Employment growth

```{r}
ggscatterstats(filtered_master1, employment_growth, GDP_per_capita_growth,
               title = "Relationship Between GDP Per Capita Growth & Employment Growth",
               caption = "Source: LinkedIn & World Bank Group",
               ggplot.component = list(ggplot2::
                        aes(employment_growth, GDP_per_capita_growth,
                            colour = year),
                        xlab("Employment Growth"),
                        ylab("GDP Per\nCapita\nGrowth"),
                        theme(axis.title.y = element_text(angle = 0)),
                        geom_hline(yintercept = 0,
                                   linetype = "dashed",
                                   color = "grey60",
                                   size = 1),
                        geom_vline(xintercept = 0,
                                   linetype = "dashed",
                                   color = "grey60",
                                   size = 1)))
```

```{r}
ols_regress(GDP_per_capita_growth ~ employment_growth, filtered_master1)
```

* GDP per capita growth vs Industry migration

```{r}
ggscatterstats(filtered_master1, industry_migration, GDP_per_capita_growth,
               title = "Relationship Between GDP Per Capita Growth & Industry Migration",
               caption = "Source: LinkedIn & World Bank Group",
               ggplot.component = list(ggplot2::
                        aes(industry_migration, GDP_per_capita_growth,
                            colour = year),
                        xlab("Industry Migration (Net Per 10)"),
                        ylab("GDP Per\nCapita\nGrowth"),
                        theme(axis.title.y = element_text(angle = 0)),
                        geom_hline(yintercept = 0,
                                   linetype = "dashed",
                                   color = "grey60",
                                   size = 1),
                        geom_vline(xintercept = 0,
                                   linetype = "dashed",
                                   color = "grey60",
                                   size = 1)))
```

```{r}
ols_regress(GDP_per_capita_growth ~ industry_migration, filtered_master1)
```

* GDP per capita growth vs Skill migration

```{r}
ggscatterstats(filtered_master2, skill_migration, GDP_per_capita_growth,
               title = "Relationship Between GDP Per Capita Growth & Skill Migration",
               caption = "Source: LinkedIn & World Bank Group",
               ggplot.component = list(ggplot2::
                        aes(skill_migration, GDP_per_capita_growth,
                            colour = year),
                        xlab("Skill Migration (Net Per 10)"),
                        ylab("GDP Per\nCapita\nGrowth"),
                        theme(axis.title.y = element_text(angle = 0)),
                        geom_hline(yintercept = 0,
                                   linetype = "dashed",
                                   color = "grey60",
                                   size = 1),
                        geom_vline(xintercept = 0,
                                   linetype = "dashed",
                                   color = "grey60",
                                   size = 1)))
```

```{r}
ols_regress(GDP_per_capita_growth ~ skill_migration, filtered_master2)
```

* Employment growth vs Industry migration

```{r}
ggscatterstats(filtered_master1, industry_migration, employment_growth,
               title = "Relationship Between Employment Growth & Industry Migration",
               caption = "Source: LinkedIn & World Bank Group",
               ggplot.component = list(ggplot2::
                        aes(industry_migration, employment_growth,
                            colour = year),
                        xlab("Industry Migration (Net Per 10)"),
                        ylab("Employment\nGrowth"),
                        theme(axis.title.y = element_text(angle = 0)),
                        geom_hline(yintercept = 0,
                                   linetype = "dashed",
                                   color = "grey60",
                                   size = 1),
                        geom_vline(xintercept = 0,
                                   linetype = "dashed",
                                   color = "grey60",
                                   size = 1)))
```

```{r}
ols_regress(employment_growth ~ industry_migration, filtered_master1)
```

* Employment growth vs Skill migration

```{r}
ggscatterstats(filtered_master2, skill_migration, employment_growth,
               title = "Relationship Between Employment Growth & Skill Migration",
               caption = "Source: LinkedIn & World Bank Group",
               ggplot.component = list(ggplot2::
                        aes(skill_migration, employment_growth,
                            colour = year),
                        xlab("Skill Migration (Net Per 10)"),
                        ylab("Employment\nGrowth"),
                        theme(axis.title.y = element_text(angle = 0)),
                        geom_hline(yintercept = 0,
                                   linetype = "dashed",
                                   color = "grey60",
                                   size = 1),
                        geom_vline(xintercept = 0,
                                   linetype = "dashed",
                                   color = "grey60",
                                   size = 1)))
```

```{r}
ols_regress(employment_growth ~ skill_migration, filtered_master2)
```

# 2.7 Correlation Plots

Next, we will find out the correlation of the variables. Given that there are very few variables (only 4), we will use ggcorrmat (under ggstatsplot package) instead of corrplot and other packages, as it will produce a simple correlation plot. We will use the default properties i.e. upper triangular matrix and significance level of 0.05. Both filtered data tables are used for the correlation plots.

It is noted that GDP per capita growth is weakly correlated with employment growth, industry and skill migration. Industry and skill migration are highly correlated (>0.8) for both plots. The results will be further discussed in the later section.

```{r}
ggcorrmat(filtered_master1,
          cor.vars = c(7, 10, 11, 12))
```

```{r}
ggcorrmat(filtered_master2,
          cor.vars = c(7, 10, 11, 12))
```

# 2.8 Multiple Regression

In addition to the simple regression plots, we will build a multiple regression model in this assignment using the olsrr package to study the relationship between GDP per capita growth and multiple variables i.e. employment growth, industry and skill migration. 3 multiple regression models are created, one with employment growth, industry and skill migration as dependent variables and we will remove industry migration or skill migration for the other two, as they are highly correlated, as seen in the earlier correlation plots.

All the regression models show weak relationship (low R-squared values) between GDP per capita growth and the dependent variables. We will further discuss the results in the later section.

```{r}
ols_regress(GDP_per_capita_growth ~ employment_growth + industry_migration
            + skill_migration,
            filtered_master1)
```

```{r}
ols_regress(GDP_per_capita_growth ~ employment_growth + industry_migration,
            filtered_master1)
```

```{r}
ols_regress(GDP_per_capita_growth ~ employment_growth + skill_migration,
            filtered_master1)
```

# 2.9 Stepwise Regression

Finally, we also carry out stepwise regression to remove variable(s) that is not important to the regression model, based on the p value. The olsrr package (ols_step_backward_aic) is used to carry out backward stepwise regression.

```{r}
ols_step_backward_aic(lm(GDP_per_capita_growth ~ employment_growth + industry_migration
                         + skill_migration, filtered_master1))
```

As seen in the backward stepwise regression result, employment growth is removed. We will build a regression model without employment growth to explore the results. However, the regression model still shows a weak relationship (low R-squared values) between GDP per capita growth and the dependent variables. We will further discuss the results in the later section.

```{r}
ols_regress(GDP_per_capita_growth ~ industry_migration + skill_migration, filtered_master1)
```

# 3.0 Final Data Visualisation

Subsequently, we will combine the interactive filters, regression plot and correlation plot on R Shiny app to produce an interactive, user-friendly dashboard. Figure 9 shows the final dashboard or data visualisation.

![Figure 9: Final Data Visualisation](https://raw.githubusercontent.com/louischong1990/blog/master/Assignment/Images/Picture9.png)

# 3.1 Key Observations

...

* [1A] Increasing employability - What are the highly sought-after skills to build up to increase employability in a particular country or a particular sector?
* [1B] Employment opportunities - Which country holds better employment opportunities for certain skills or certain industry?
* [2E] GDP per capita growth - How is GDP per capita growth impacted by migration and employment growth in our country?

Relationship for GDP per capita growth vs employment growth / industry migration / skill migration not strong, surprising that more employment growth and migration lead to lower GDP per capita growth
Relationship for employment growth vs industry migration / skill migration is decent, more migration leads to more employment growth

It is noted that GDP per capita growth is weakly correlated with employment growth, industry and skill migration. Industry and skill migration are highly correlated (>0.8) for both plots.

All the regression models show weak relationship (low R-squared values) between GDP per capita growth and the dependent variables.
any other factors that influence GDP per capita growth
